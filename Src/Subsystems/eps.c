#include "eps_internal.h"

// The main functionality of the EPS task is providing the OBC with battery readings on 
// it's voltage, current generated, capacity, temperature and charging status. The task 
// will also indicate any error generated by the Power Management IC.

// Function prototypes
void setup_eps(void);
void process_eps(void);

void eps_task(void *pv_parameters)
{

    setup_eps();

    // PROCESS STAGE

    //  it does not have different performances depending on the mode

    for (;;)
    {
        process_eps();
    }
}

static void setup_eps(void)
{
    print("Setting up EPS...");
    // Apply the default configuration
}

static void process_eps(void)
{

    print("Processing EPS...");
    // 1. Checks EPS notifications (DOESN'T BLOCK) to see whether to perform notification actions
            
    // If there are actions to be taken, process them accordingly.

    // 2. Poll battery sensor (DS2782E+) for voltage, current and capacity. This IC is 
    // connected to the IC2 line 1 (SCL1,SDA1).

    // 3. Send to OBDH task for it to store to flash 

}